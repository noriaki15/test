<!DOCTYPE html>
<html>
<head>
    <title>AR.js 간단한 거리 계산</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/ar.js/aframe/build/aframe-ar.min.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene 
        embedded 
        arjs="sourceType: webcam; gpsMinAccuracy: 100; debugUIEnabled: false;">
        
        <!-- 캐릭터 -->
        <a-entity 
            gps-entity-place="latitude: 33.890910; longitude: 130.711773;"
            gltf-model="orio.gltf"
            scale="1 1 1">
        </a-entity>

        <!-- 거리 텍스트 -->
        <a-entity 
            id="distance-text"
            gps-entity-place="latitude: 33.890910; longitude: 130.711773;"
            text="value: Calculating distance...; align: center; color: blue;"
            position="0 2 0"
            scale="10 10 10">
        </a-entity>

        <!-- 카메라 -->
        <a-camera gps-camera rotation-reader></a-camera>
    </a-scene>

    <script>
        document.querySelector('a-scene').addEventListener('loaded', () => {
            const camera = document.querySelector('[gps-camera]');
            const textEntity = document.querySelector('#distance-text');
            
            // 목적지 좌표
            const targetLat = 33.890910;
            const targetLon = 130.711773;

            // 거리 계산 함수
            const calculateDistance = (lat1, lon1, lat2, lon2) => {
                const latDiff = lat2 - lat1;
                const lonDiff = lon2 - lon1;
                return Math.sqrt(latDiff ** 2 + lonDiff ** 2) * 111139; // 1도 ≈ 111,139m
            };

            // 사용자 위치 업데이트 이벤트
            camera.addEventListener('gps-camera-update-position', (event) => {
                const userLat = event.detail.position.latitude;
                const userLon = event.detail.position.longitude;

                const distance = calculateDistance(userLat, userLon, targetLat, targetLon);
                textEntity.setAttribute('text', `value: Distance: ${Math.round(distance)}m; align: center; color: blue;`);
            });
        });
    </script>
</body>
</html>
